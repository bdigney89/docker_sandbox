Mostly copied and adapted from Muhammad Luqman's tutorial. Thanks Muhammad, all your stuff is great. bd.